<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Деревотряска</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/wrike.css">
    <link rel="stylesheet" href="style.css" media="all">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <style>
      .reveal .solid {
        width: 2ex;
        display:inline-block;
        text-align:center;
        font-weight: 400;
      }
      .reveal li {
        margin-bottom: .5em;
      }
      .reveal pre.opacity * {
        color: rgba(255,255,255, 0.3) !important;
      }
      .reveal .tag {
        width: 12ex;
        display:inline-block;
        float: left;
        font-weight:500;
      }

      .reveal pre.opacity mark,
      .reveal pre.opacity mark * {
        color: rgba(255,255,255, 1) !important;
        background-color:transparent;
      }

      .reveal mark,
      .reveal mark * {
        color: #fff;
        font-weight: 600;
        background-color: #000;
      }

      .reveal ul.solid-ul li {
        list-style:none;
      }

      .hidden {
        visibility:hidden;
      }
    </style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h4>
            Что посеешь, то и пожмешь
            <br />
            <small>
              поучительные истории про сжатие javascript
            </small>
          </h4>
          <p>Алексей Золотых, Wrike</p>
        </section>
        <section>
          <img src="img/wrike.com.png" alt="">
        </section>
        <section>
          <img src="img/screen1.png" alt="">
        </section>
        <section>
          <img src="img/dart.svg" width="500px" alt="">
          <p class="fragment" style="text-align: center; font-size: 80px">⬇︎</p>
          <img class="fragment" src="img/js.svg" width="300px" alt="">
        </section>
        <section data-transition="slide none">
          <h4>
            1 минута на доклад
          </h4>
          <ul>
            <li class="fragment">Бекенд != Фронтенд</li>
            <li class="fragment">Нужно понимать как все устроено</li>
          </ul>
        </section>
        <section data-transition="none">
          <h4>
            1 минута на доклад
          </h4>
          <ul>
            <li><mark>Бекенд != Фронтенд</mark></li>
            <li>Нужно понимать как все устроено</li>
          </ul>
        </section>
        <section>
          <p>
            Ситацию хорошо иллюстрирует left-pad
          </p>
        </section>
        <section data-background="#000">
          <div class="fade"></div>
          <div class="star-wars">
            <div class="crawl">
              <div class="title">
                <p>holy wars</p>
                <h1>Left-pad</h1>
              </div>
              <p>Веб-разработчик Азер Кочулу (Azer Koçulu), автор более 250 модулей для Node.js, попал в неприятную ситуацию. В своём блоге он пишет, что несколько недель назад получил письмо от юриста компании Kik (мессенджер) с требованием отозвать модуль с аналогичным названием kik из пакетного менеджера NPM (Node Package Manager).
              </p>
              <p>
                Программист отказался, тогда юрист обратился напрямую в NPM, и администрация проекта удовлетворила его требование, сменив владельца kik без разрешения автора.
              </p>
              <p>
                Азер Кочулу был крайне недоволен этим. Настолько недоволен, что решил в ответ «освободить» (то есть отозвать) все свои модули — более 250 модулей NPM. К сожалению, среди них оказался и left-pad — маленький модуль из 11 строк кода на JavaScript. Он используется при установке зависимостей между пакетами через NPM, в том числе в Node.js, JavaScript-транскомпиляторе Babel и огромном количестве других билдов. Только за прошлый месяц left-pad скачали 2 486 696 с сервера NPM, по их статистике.
              </p>
              <p>
                Код left-pad показан ниже. Он просто заполняет левую часть строки нулями или пробелами.
              </p>
              <p>
                Несмотря на простоту модуля, в тысячах приложений менеджер NPM теперь не мог установить зависимости между пакетами.
              </p>
              <p>
                Чтобы в экстренном порядке исправить ситуацию, технический директор и сооснователь NPM Лори Восс (Laurie Voss) пошёл беспрецедентный шаг (так он назвал его в твиттере) и, «учитывая серьёзность и распространённость проблемы», отменил отзыв модуля. Была опубликована старая версия модуля, аналогичная последней.
              </p>
              <p>
                Сам Азер Кочулу считает, что администрация NPM берёт на себя слишком много полномочий. Он верит в силу движения Open Source и призывает создать «по-настоящему свободную альтернативу NPM». Азер просит прощения у всех веб-разработчиков, кто пострадал в результате его действий. Модуль Kik и другие он выложил на Github.
              </p>
            </div>
          </div>
        </section>
        <section>
          Hello world!
        </section>
        <section>
          <img src="img/helloworld.png" alt="">
        </section>
        <section>
          <h4>Vanilla JS</h4>
          <pre><code class="center" style="width: 800px">document.body.innerHTML="Hello world"</code></pre>
        </section>
        <section>
          <p>
            Spring boot (Java)
          </p>
          <pre><code class="center" style="width: 600px" data-trim>
    @RequestMapping("/")
    @ResponseBody
    String home() {
        return "Hello World!";
    }
          </code></pre>
        </section>
        <section>
          <p>Минутка тро-ло-ло</p>
          <img src="img/2.jpg" alt="">
        </section>
        <section>
          <pre><code class="center" style="font-size: 5vh; width: 1400px; max-height: none" data-trim>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ru&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
 &lt;script src=&quot;./build/libs/gs-spring-boot-0.1.0.jar&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
          </code></pre>
        </section>
        <section>
          <h4>Приложение в реальной жизни</h4>
          <img src="img/3g.png" alt="">
        </section>
        <section data-background-video="img/java0.mov"></section>
        <section data-background-video="img/java.mov"></section>
        <section>
          <img src="img/helloworld.png" alt="">
        </section>
        <section data-transition="slide none">
          <p>С чего все началось</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;jquery.min.js&quot;&gt;&lt;/script&gt;
  &lt;!--Плагины и код--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>С чего все началось</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;jquery.min.js&quot;&gt;&lt;/script&gt;
  &lt;!--Плагины и код--&gt;
  &lt;!--Еще больше плагинов и кода--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>С чего все началось</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;jquery.min.js&quot;&gt;&lt;/script&gt;
  &lt;!--Плагины и код--&gt;
  &lt;!--Еще больше плагинов и кода--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>С чего все началось</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;jquery.min.js&quot;&gt;&lt;/script&gt;
  &lt;!--Плагины и код--&gt;
  &lt;!--Еще больше плагинов и кода--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>С чего все началось</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;jquery.min.js&quot;&gt;&lt;/script&gt;
  &lt;!--Плагины и код--&gt;
  &lt;!--Еще больше плагинов и кода--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Меньше файлов → меньше затраты на сеть</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim>
&lt;body&gt;
  &lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.<mark>min</mark>.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.<mark>min</mark>.js&quot;&gt;&lt;/script&gt;
  &lt;!--Плагины и код--&gt;
  &lt;!--Еще больше плагинов и кода--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.min.js&quot;&gt;&lt;/script&gt;
  <mark>&lt;!--Плагины и код--&gt;</mark>
  &lt;!--Еще больше плагинов и кода--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.min.js&quot;&gt;&lt;/script&gt;
  <mark>&lt;!--Backbone классы--&gt;</mark>
  &lt;!--Еще больше классов--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.min.js&quot;&gt;&lt;/script&gt;
  <mark>&lt;!--Angular классы--&gt;</mark>
  &lt;!--Еще больше г;вна и палок--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.min.js&quot;&gt;&lt;/script&gt;
  <mark>&lt;!--React компоненты--&gt;</mark>
  &lt;!--Еще больше преферанса и поэтес--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="none">
          <p>Браузер не оценит читаемость кода</p>
          <pre><code data-trim data-noescape>
&lt;body&gt;
  &lt;script src=&quot;bundle.min.js&quot;&gt;&lt;/script&gt;
  <mark>&lt;!--Vue js компоненты--&gt;</mark>
  &lt;!--Еще больше крафтового пива--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
  &lt;!--больше больше больше--&gt;
&lt;/body&gt;
          </code></pre>
        </section>
        <section data-transition="slide none">
          <p>node</p>
          <p class="fragment">
            Дайте нам нормальные модули!
          </p>
        </section>
        <section data-transition="none">
          <p>ES6+</p>
          <p>
            Дайте нам нормальные модули!
          </p>
        </section>
        <section data-transition="none">
          <p>ES6+</p>
          <p>
            Дайте нам нормальные модули в браузере!
          </p>
        </section>
        <section>
          И теперь мы могём так
          <pre><code data-trim>
import _ from 'lodash';

if (_.has([1, 2, 3], 2)) {
  console.log("debug");
}
          </code></pre>
        </section>
        <section>
          <p>
            И получаем...
          </p>
        </section>
        <section>
          <table>
            <tr>
              <th>Сборщик</th>
              <th>Размер</th>
            </tr>
            <tr>
              <td>Webpack</td>
              <td>531k</td>
            </tr>
            <tr>
              <td>Rollup</td>
              <td>528k</td>
            </tr>
          </table>
        </section>
        <section data-transition="slide,none">
          <pre><code data-trim>
import has from 'lodash/has';

if (has([1, 2, 3], 2)) {
  //ЖГИ!
}
          </code></pre>
      </section>
      <section data-transition="slide,none">
        <pre><code data-trim data-noescape>
import has from <mark>'lodash/has'</mark>;

if (has([1, 2, 3], 2)) {
  // ЖГИ
}
          </code></pre>
    </section>
    <section>
      <table>
        <tr>
          <th>Сборщик</th>
          <th>Размер</th>
        </tr>
        <tr>
          <td>Webpack</td>
          <td>42к</td>
        </tr>
        <tr>
          <td>Rollup</td>
          <td>33к</td>
        </tr>
      </table>
    </section>
    <section>
      <p>Вместо 42k можно написать примерно вот так</p>
      <pre><code data-trim>
if([1,2,3].indexOf(2) != -1){
  //ЖГИ
}
          </code></pre>
    </section>
    <section data-transition="none">
      <pre><code data-trim>
const has = (arr,input) =&gt; arr.indexOf(input) != -1

if(has([1,2,3], 2)){
  //ЖГИ
}
          </code></pre>
  </section>
  <section data-transition="none">
    <pre><code data-trim data-noescape>
<mark>const has = (arr,input) =&gt; arr.indexOf(input) != -1</mark>

if(has([1,2,3], 2)){
  //ЖГИ
}
          </code></pre>
</section>
<section>
  Ничего не напоминает?
</section>
<section data-background="#000">
  <div class="fade"></div>
  <div class="star-wars">
    <div class="crawl">
      <div class="title">
        <p>holy wars</p>
        <h1>Left-pad</h1>
      </div>
      <p>Веб-разработчик Азер Кочулу (Azer Koçulu), автор более 250 модулей для Node.js, попал в неприятную ситуацию. В своём блоге он пишет, что несколько недель назад получил письмо от юриста компании Kik (мессенджер) с требованием отозвать модуль с аналогичным названием kik из пакетного менеджера NPM (Node Package Manager).
      </p>
      <p>
        Программист отказался, тогда юрист обратился напрямую в NPM, и администрация проекта удовлетворила его требование, сменив владельца kik без разрешения автора.
      </p>
      <p>
        Азер Кочулу был крайне недоволен этим. Настолько недоволен, что решил в ответ «освободить» (то есть отозвать) все свои модули — более 250 модулей NPM. К сожалению, среди них оказался и left-pad — маленький модуль из 11 строк кода на JavaScript. Он используется при установке зависимостей между пакетами через NPM, в том числе в Node.js, JavaScript-транскомпиляторе Babel и огромном количестве других билдов. Только за прошлый месяц left-pad скачали 2 486 696 с сервера NPM, по их статистике.
      </p>
      <p>
        Код left-pad показан ниже. Он просто заполняет левую часть строки нулями или пробелами.
      </p>
      <p>
        Несмотря на простоту модуля, в тысячах приложений менеджер NPM теперь не мог установить зависимости между пакетами.
      </p>
      <p>
        Чтобы в экстренном порядке исправить ситуацию, технический директор и сооснователь NPM Лори Восс (Laurie Voss) пошёл беспрецедентный шаг (так он назвал его в твиттере) и, «учитывая серьёзность и распространённость проблемы», отменил отзыв модуля. Была опубликована старая версия модуля, аналогичная последней.
      </p>
      <p>
        Сам Азер Кочулу считает, что администрация NPM берёт на себя слишком много полномочий. Он верит в силу движения Open Source и призывает создать «по-настоящему свободную альтернативу NPM». Азер просит прощения у всех веб-разработчиков, кто пострадал в результате его действий. Модуль Kik и другие он выложил на Github.
      </p>
    </div>
  </div>
</section>
<section>
  Если хочется наглядности
</section>
<section data-background="img/cost.gif" data-background-size="1257px 219px"> </section>
<section>
  <p>Import Cost</p>
  <ul>
    <li>JetBrains &mdash; <a href="https://plugins.jetbrains.com/plugin/9970-import-cost">https://goo.gl/vRJnP2</a></li>
    <li>VS Code &mdash; <a href="https://marketplace.visualstudio.com/items?itemName=wix.vscode-import-cost">https://goo.gl/MirhQE</a></li>
  </ul>
</section>
<section>
  <pre><code data-trim>
_.padStart('abc', 6);
// =&gt; '   abc'
          </code></pre>

        </section>
        <section>
          В javascript нет SDK
        </section>
        <section data-transition="none">
          <h4>
            2 вывода
          </h4>
          <ul>
            <li><mark>Бекенд != Фронтенд</mark></li>
            <li>Нужно понимать как все устроено</li>
          </ul>
        </section>
        <section data-transition="none">
          <h4>
            2 вывода
          </h4>
          <ul>
            <li>Бекенд != Фронтенд &mdash; ✓</li>
            <li>Нужно понимать как все устроено</li>
          </ul>
        </section>
        <section data-transition="none">
          <h4>
            2 вывода
          </h4>
          <ul>
            <li>Бекенд != Фронтенд &mdash; ✓</li>
            <li><mark>Нужно понимать как все устроено</mark></li>
          </ul>
        </section>
        <section data-transition="none">
          <p>
            Уменьшение объема результирующего js
          </p>
          <ul>
            <li class="fragment">
              gzip
              <span class="fragment">, Brotli</span>
              <span class="fragment">, Zopfli</span>
            </li>
            <li class="fragment">уменьшение содержимого файла</li>
          </ul>
        </section>
        <section>
          <pre><code>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt; &lt;/head&gt;
&lt;body&gt;
  &lt;script src=&quot;./index.js&quot;&gt;&lt;/script&gt;    <!--5 megabytes-->
&lt;/body&gt;
&lt;/html&gt;
          </code></pre>
        </section>
        <section>
          <h3>Network &mdash; 100ms</h3>
          <img src="img/network.png" alt="">
        </section>
        <section>
          <h3>Parse &mdash; 300ms</h3>
          <img src="img/parse.png" alt="">
        </section>
        <section>
          <h3>Evaluate &mdash; 500ms</h3>
          <img src="img/evaluate.png" alt="">
        </section>
        <section data-transition="none">
          <p>
            Уменьшение объема кода
          </p>
          <ul>
            <li>gzip</li>
            <li><mark>уменьшение самого файла</mark></li>
          </ul>
        </section>
        <section>
          <p>
            tree-shaking vs dead code illumination - <a href="https://medium.com/@Rich_Harris/tree-shaking-versus-dead-code-elimination-d3765df85c80">goo.gl/SJDr78</a>
          </p>
          <p>Rich Harris</p>
        </section>
        <section data-background="img/tree.jpg"></section>
        <section>
          <p>module.js</p>
          <pre><code data-trim>
export function square(x) {
  return x * x;
}

export function cube(x) {
  return x * x * x;
}
          </code></pre>
        </section>
        <section>
          <p>index.js</p>
          <pre><code data-trim>
import {cube} from './module'

console.log(cube(x))
          </code></pre>
        </section>
        <section data-transition="slide none">
          <pre><code data-trim style="max-height: 500px">
...
/* unused harmony export square */
/* harmony export (immutable) */ __webpack_exports__["a"] = cube;
function square(x) {
  return x * x;
}

function cube(x) {
  return x * x * x;
}
...
          </code></pre>
        </section>
        <section data-transition="none slide">
          <pre><code data-trim data-noescape style="max-height: 500px">
...
<mark>/* unused harmony export square */</mark>
/* harmony export (immutable) */ __webpack_exports__["a"] = cube;
function square(x) {
  return x * x;
}

function cube(x) {
  return x * x * x;
}
...
          </code></pre>
        </section>
        <section>
          <p>module.js</p>
          <pre><code>
export class MyClass {
    print(){
        console.log('find me');
    }
}
          </code></pre>
        </section>
        <section data-transition="slide none">
          <pre><code data-trim style="max-height: 600px">
/* unused harmony export MyClass */
var MyClass = function () {
  function MyClass() {
    babelHelpers.classCallCheck(this, MyClass);
  }

  MyClass.prototype.turn = function print() {
    console.log('find me');
  };

  return MyClass;
}();
          </code></pre>
        </section>
        <section data-transition="none slide">
          <pre><code data-noescape data-trim style="max-height: 600px">
/* unused harmony export MyClass */
<mark>var MyClass = function () {</mark>
  function MyClass() {
    babelHelpers.classCallCheck(this, MyClass);
  }

  MyClass.prototype.turn = function print() {
    console.log('find me');
  };

  return MyClass;
}();
          </code></pre>
        </section>
        <section>
          <p>
            UglifyJS не понимает, что выкидывать
          </p>
        </section>
        <section>
          <img src="img/dasha.jpg" alt="">
          <p>
          Давайте поможем UglifyJS выкинуть ненужный класс!
          </p>
        </section>
        <section>
          <pre><code data-trim data-noescape>
...
/* unused harmony export MyClass */
var MyClass  =  <mark>/*#__PURE__*/</mark> function () {
...
          </code></pre>
        </section>
        <section>
          <p>Как починить</p>
          <ul>
            <li class="fragment">Babel 7</li>
            <li class="fragment">Webpack</li>
          </ul>
        </section>
        <section>
          <p>index.js</p>
          <pre><code data-trim>
import {cube} from './module'

console.log(cube(x))
          </code></pre>
        </section>
        <section>
!function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";t.r(r);var n;console.log((n=3)*n*n)}]);
        </section>
        <section>
          А не слишком ли это много?!
        </section>
        <section>
          <p>Код на Dart</p>
          <pre><code>
void main() {
  print(cube(3));
}

int cube(int x) =&gt; x * x * x;
int square(int x) =&gt; x * x;
          </code></pre>
        </section>
        <section>
          <p>Dart - 8kb</p>
        </section>
        <section>
          <p>Cтандартная библиотека + </p>
          <pre class="fragment"><code>
...
    main: function() {
      H.printString("27");
    }
...
          </code></pre>
        </section>
        <section>
          Чудеса грядут
        </section>
        <section>
          <pre><code data-trim>
class Car {
  Rudder rudder;
  Wheel wheel;
}
          </code></pre>
        </section>
        <section>
          <pre><code data-trim>
class Rudder {
  void turn(){ print('turn'); }
}

class Wheel {
  void pump(){ print('pump'); }
}
          </code></pre>
        </section>
        <section>
          <pre><code data-trim>
void main(){
  final car = new Car();
  car.wheel = new Wheel();
  car.rudder = new Rudder();
  car.rudder.turn();
}
          </code></pre>
        </section>
        <section>
          <p>Cтандартная библиотека + </p>
          <pre class="fragment"><code>
...
main: function() {
  H.printString("turn");
}
...
          </code></pre>
        </section>
        <section>
          <p>
            &mdash; Почему так не может UglifyJS?!
          </p>
        </section>
        <section>
          <p>Потому что он использует AST</p>
          <img src="img/ast.png" alt="">
        </section>
        <section>
          Dart использует SSA форму для оптимизаций
        </section>
        <section>
          <p>
            <b>SSA</b> (<i>англ</i>. <b>Static single assignment form)</b> — промежуточное представление, используемое компиляторами, в котором каждой переменной значение присваивается лишь единожды
          </p>
        </section>
        <section>
          <p>Static Single Assignment Book</p>
          <a href="http://ssabook.gforge.inria.fr/latest/book.pdf">http://ssabook.gforge.inria.fr/latest/book.pdf</a>
        </section>
        <section>
          Я не хочу писать на мертвом языке, можно мне использовать SSA в JS?
        </section>
        <section>
          <pre><code data-trim style="max-height: none">
class Car {}

class Rudder {
  turn(){console.log('turn');}
}

class Wheel {
  pump(){console.log('pump')}
}

let car = new Car();
car.wheel = new Wheel();
car.rudder = new Rudder();

car.rudder.turn();
          </code></pre>
        </section>
        <section data-transition="slide none">
          <p>prepack.io</p>
          <pre><code data-trim style="max-height: none">
(function () {
  var _$0 = this;
  var _0 = class {};

  Car = _0;
  var _2 = class { turn() { console.log('turn'); } };

  Rudder = _2;
  var _5 = class { pump() { console.log('pump'); } };

  Wheel = _5;
  console.log("turn");
}).call(this);
          </code></pre>
        </section>
        <section data-transition="slide none">
          <p>prepack.io</p>
          <pre><code data-noescape data-trim style="max-height: none">
(function () {
  var _$0 = this;
  var _0 = class {};

  Car = _0;
  var _2 = class { turn() { console.log('turn'); } };

  Rudder = _2;
  var _5 = class { pump() { console.log('pump'); } };

  Wheel = _5;
  <mark>console.log("turn")</mark>;
}).call(this);
          </code></pre>
        </section>
        <section>
          *Prepack is still in an early development stage and not ready for production use just yet. Please try it out, give feedback, and help fix bugs.
        </section>
        <section>
          GCC - Google Closure Compiler <a href="https://developers.google.com/closure/compiler/">https://developers.google.com/closure/compiler/</a>
        </section>
        <section>
          <pre><code data-trim>
            java -jar node_modules/google-closure-compiler/compiler.jar \
              --compilation_level ADVANCED \
              --language_in=ES6 \
              --js ./src/index.js ./src/module.js &gt; out.dev.js
          </code></pre>
        </section>
        <section>
          <pre><code data-trim>
console.log("turn");
          </code></pre>
        </section>
        <section>
          <p>
            Подводные камни
          </p>
          <pre class="fragment"><code data-trim>
  &lt;script&gt;
    var rudder = new Rudder();
  &lt;/script&gt;
          </code></pre>
        </section>
        <section>
          <pre><code>
function displayNoteTitle(note) {
  alert(note['myTitle']);
}
// Store the function in a global property referenced by a string:
window['displayNoteTitle'] = displayNoteTitle;
          </code></pre>
        </section>
        <section data-transition="slide none">
          <pre><code data-trim>
function displayNoteTitle(note) {
  alert(note['myTitle']);
}
var flowerNote = {};
flowerNote.myTitle = 'Flowers';

alert(flowerNote.myTitle);
displayNoteTitle(flowerNote);
          </code></pre>
        </section>
        <section data-transition="none">
          <pre><code data-trim data-noescape>
function displayNoteTitle(note) {
  <mark>alert(note['myTitle']);</mark>
}
var flowerNote = {};
flowerNote.myTitle = 'Flowers';

alert(flowerNote.myTitle);
displayNoteTitle(flowerNote);
          </code></pre>
        </section>
        <section data-transition="none slide">
          <pre><code data-trim data-noescape>
function displayNoteTitle(note) {
  alert(note['myTitle']);
}
var flowerNote = {};
<mark>flowerNote.myTitle = 'Flowers';</mark>

alert(flowerNote.myTitle);
displayNoteTitle(flowerNote);
          </code></pre>
        </section>
        <section data-transition="slide none">
          <pre><code>
var a={};a.a="Flowers";alert(a.a);alert(a.myTitle);
          </code></pre>
        </section>
        <section data-transition="none">
          <pre><code data-trim data-noescape>
var a={};<mark>a.a="Flowers"</mark>;alert(a.a);alert(a.myTitle);
          </code></pre>
        </section>
        <section data-transition="none">
          <pre><code data-trim data-noescape>
var a={};a.a="Flowers";alert(a.a);alert(<mark>a.myTitle</mark>);
          </code></pre>
        </section>
        <section>
          <p>Сторонние библиотеки</p>
          <pre><code data-trim data-noescape>
java -jar compiler.jar --compilation_level ADVANCED_OPTIMIZATIONS \
  --js makeallnotes.js <mark>--externs extern1.js</mark> --externs extern2.js
          </code></pre>
        </section>
  <section>
    <p>Uglify vs Google Closure Compiler</p>
    <p>
      Сравнение - <a href="https://goo.gl/suo6gq">https://goo.gl/suo6gq</a>
    </p>
  </section>
  <section data-transition="none">
    <h4>
      2 вывода
    </h4>
    <ul>
      <li>Бекенд != Фронтенд &mdash; ✓</li>
      <li><mark>Нужно понимать как все устроено</mark></li>
    </ul>
  </section>
  <section data-transition="none">
    <h4>
      2 вывода
    </h4>
    <ul>
      <li>Бекенд != Фронтенд &mdash; ✓</li>
      <li>Нужно понимать как все устроено &mdash; ✓</li>
    </ul>
  </section>
  <section>
    Спасибо за внимание!
    <p>
      twitter: <a href="https://twitter.com/zolotyh">@zolotyh</a>
    </p>
    <p>
      Слайды: <a href="https://zolotyh.github.io/secon-2018/">https://zolotyh.github.io/secon-2018/</a>
    </p>
  </section>
</div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
  controls: true,
  width: 1280,
	height: 1024,
  progress: true,
  slideNumber: true,
  history: true,
  dependencies: [
    { src: 'plugin/markdown/marked.js' },
    { src: 'plugin/markdown/markdown.js' },
    { src: 'plugin/notes/notes.js', async: true },
    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
  ]
});
    </script>
  </body>
</html>
